Authenticating with public key "imported-openssh-key"
     ┌────────────────────────────────────────────────────────────────────┐
     │                        • MobaXterm 10.8 •                          │
     │            (SSH client, X-server and networking tools)             │
     │                                                                    │
     │ ➤ SSH session to ubuntu@54.196.124.55                              │
     │   • SSH compression : ✔                                            │
     │   • SSH-browser     : ✔                                            │
     │   • X11-forwarding  : ✔  (remote display is forwarded through SSH) │
     │   • DISPLAY         : ✔  (automatically set on remote server)      │
     │                                                                    │
     │ ➤ For more info, ctrl+click on help or visit our website           │
     └────────────────────────────────────────────────────────────────────┘

Welcome to Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-1021-aws x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Tue Oct 16 05:46:18 UTC 2018

  System load:  0.15              Processes:           89
  Usage of /:   13.3% of 7.69GB   Users logged in:     0
  Memory usage: 14%               IP address for eth0: 172.31.42.33
  Swap usage:   0%

  Get cloud support with Ubuntu Advantage Cloud Guest:
    http://www.ubuntu.com/business/services/cloud

0 packages can be updated.
0 updates are security updates.



The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

/usr/bin/xauth:  file /home/ubuntu/.Xauthority does not exist
To run a command as administrator (user "root"), use "sudo <command>".
See "man sudo_root" for details.

ubuntu@ip-172-31-42-33:~$ sudo -i
root@ip-172-31-42-33:~# vi /etc/hostname
root@ip-172-31-42-33:~# hostname ansiblemaster
root@ip-172-31-42-33:~# exec bash
root@ansiblemaster:~# sudo apt-get update
Hit:1 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic InRelease
Get:2 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates InRelease [88.7 kB]
Get:3 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-backports InRelease [74.6 kB]
Get:4 http://security.ubuntu.com/ubuntu bionic-security InRelease [83.2 kB]
Get:5 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/multiverse Sources [181 kB]
Get:6 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main Sources [829 kB]
Get:7 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/restricted Sources [5324 B]
Get:8 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/universe Sources [9051 kB]
Get:9 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/universe amd64 Packages [8570 kB]
Get:10 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/universe Translation-en [4941 kB]
Get:11 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/multiverse amd64 Packages [151 kB]
Get:12 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/multiverse Translation-en [108 kB]
Get:13 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates/main Sources [198 kB]
Get:14 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates/universe Sources [89.4 kB]
Get:15 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates/multiverse Sources [3212 B]
Get:16 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates/restricted Sources [2064 B]
Get:17 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates/main amd64 Packages [403 kB]
Get:18 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates/main Translation-en [150 kB]
Get:19 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates/restricted amd64 Packages [7028 B]
Get:20 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates/restricted Translation-en [3076 B]
Get:21 http://security.ubuntu.com/ubuntu bionic-security/main Sources [52.6 kB]
Get:22 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates/universe amd64 Packages [564 kB]
Get:23 http://security.ubuntu.com/ubuntu bionic-security/multiverse Sources [1336 B]
Get:24 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates/universe Translation-en [147 kB]
Get:25 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates/multiverse amd64 Packages [5708 B]
Get:26 http://security.ubuntu.com/ubuntu bionic-security/universe Sources [20.5 kB]
Get:27 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates/multiverse Translation-en [3176 B]
Get:28 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-backports/universe Sources [1188 B]
Get:29 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-backports/universe amd64 Packages [2852 B]
Get:30 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-backports/universe Translation-en [1200 B]
Get:31 http://security.ubuntu.com/ubuntu bionic-security/main amd64 Packages [183 kB]
Get:32 http://security.ubuntu.com/ubuntu bionic-security/main Translation-en [71.2 kB]
Get:33 http://security.ubuntu.com/ubuntu bionic-security/universe amd64 Packages [88.6 kB]
Get:34 http://security.ubuntu.com/ubuntu bionic-security/universe Translation-en [48.2 kB]
Get:35 http://security.ubuntu.com/ubuntu bionic-security/multiverse amd64 Packages [1440 B]
Get:36 http://security.ubuntu.com/ubuntu bionic-security/multiverse Translation-en [996 B]
Fetched 26.1 MB in 5s (5214 kB/s)
Reading package lists... Done
root@ansiblemaster:~#  sudo apt-get install software-properties-common
Reading package lists... Done
Building dependency tree
Reading state information... Done
software-properties-common is already the newest version (0.96.24.32.5).
0 upgraded, 0 newly installed, 0 to remove and 55 not upgraded.
root@ansiblemaster:~# sudo apt-add-repository --yes --update ppa:ansible/ansible
Hit:1 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic InRelease
Hit:2 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates InRelease
Hit:3 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-backports InRelease
Get:4 http://security.ubuntu.com/ubuntu bionic-security InRelease [83.2 kB]
Get:5 http://ppa.launchpad.net/ansible/ansible/ubuntu bionic InRelease [15.9 kB]
Get:6 http://ppa.launchpad.net/ansible/ansible/ubuntu bionic/main amd64 Packages [540 B]
Get:7 http://ppa.launchpad.net/ansible/ansible/ubuntu bionic/main Translation-en [344 B]
Fetched 100 kB in 1s (154 kB/s)
Reading package lists... Done
root@ansiblemaster:~# sudo apt-get install ansible
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following additional packages will be installed:
  libpython-stdlib libpython2.7-minimal libpython2.7-stdlib python python-asn1crypto python-cffi-backend
  python-crypto python-cryptography python-enum34 python-httplib2 python-idna python-ipaddress
  python-jinja2 python-markupsafe python-minimal python-paramiko python-pkg-resources python-pyasn1
  python-setuptools python-six python-yaml python2.7 python2.7-minimal sshpass
Suggested packages:
  python-doc python-tk python-crypto-doc python-cryptography-doc python-cryptography-vectors
  python-enum34-doc python-jinja2-doc python-gssapi python-setuptools-doc python2.7-doc binutils
  binfmt-support
The following NEW packages will be installed:
  ansible libpython-stdlib libpython2.7-minimal libpython2.7-stdlib python python-asn1crypto
  python-cffi-backend python-crypto python-cryptography python-enum34 python-httplib2 python-idna
  python-ipaddress python-jinja2 python-markupsafe python-minimal python-paramiko python-pkg-resources
  python-pyasn1 python-setuptools python-six python-yaml python2.7 python2.7-minimal sshpass
0 upgraded, 25 newly installed, 0 to remove and 55 not upgraded.
Need to get 9447 kB of archives.
After this operation, 59.6 MB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 libpython2.7-minimal amd64 2.7.15~rc1-1 [334 kB]
Get:2 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python2.7-minimal amd64 2.7.15~rc1-1 [1292 kB]
Get:3 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-minimal amd64 2.7.15~rc1-1 [28.1 kB]
Get:4 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 libpython2.7-stdlib amd64 2.7.15~rc1-1 [1910 kB]
Get:5 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python2.7 amd64 2.7.15~rc1-1 [238 kB]
Get:6 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 libpython-stdlib amd64 2.7.15~rc1-1 [7620 B]
Get:7 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python amd64 2.7.15~rc1-1 [140 kB]
Get:8 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-markupsafe amd64 1.0-1build1 [13.0 kB]
Get:9 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-jinja2 all 2.10-1 [94.6 kB]
Get:10 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-yaml amd64 3.12-1build2 [115 kB]
Get:11 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-asn1crypto all 0.24.0-1 [72.7 kB]
Get:12 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-cffi-backend amd64 1.11.5-1 [63.4 kB]
Get:13 http://ppa.launchpad.net/ansible/ansible/ubuntu bionic/main amd64 ansible all 2.7.0-1ppa~bionic [3917 kB]
Get:14 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-enum34 all 1.1.6-2 [34.8 kB]
Get:15 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-idna all 2.6-1 [32.4 kB]
Get:16 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-ipaddress all 1.0.17-1 [18.2 kB]
Get:17 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-six all 1.11.0-2 [11.3 kB]
Get:18 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic-updates/main amd64 python-cryptography amd64 2.1.4-1ubuntu1.2 [221 kB]
Get:19 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-pyasn1 all 0.4.2-3 [46.7 kB]
Get:20 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-paramiko all 2.0.0-1ubuntu1 [110 kB]
Get:21 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-httplib2 all 0.9.2+dfsg-1 [34.6 kB]
Get:22 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-crypto amd64 2.6.1-8ubuntu2 [244 kB]
Get:23 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-pkg-resources all 39.0.1-2 [128 kB]
Get:24 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/main amd64 python-setuptools all 39.0.1-2 [329 kB]
Get:25 http://us-east-1.ec2.archive.ubuntu.com/ubuntu bionic/universe amd64 sshpass amd64 1.06-1 [10.5 kB]
Fetched 9447 kB in 1s (6537 kB/s)
Selecting previously unselected package libpython2.7-minimal:amd64.
(Reading database ... 56473 files and directories currently installed.)
Preparing to unpack .../0-libpython2.7-minimal_2.7.15~rc1-1_amd64.deb ...
Unpacking libpython2.7-minimal:amd64 (2.7.15~rc1-1) ...
Selecting previously unselected package python2.7-minimal.
Preparing to unpack .../1-python2.7-minimal_2.7.15~rc1-1_amd64.deb ...
Unpacking python2.7-minimal (2.7.15~rc1-1) ...
Selecting previously unselected package python-minimal.
Preparing to unpack .../2-python-minimal_2.7.15~rc1-1_amd64.deb ...
Unpacking python-minimal (2.7.15~rc1-1) ...
Selecting previously unselected package libpython2.7-stdlib:amd64.
Preparing to unpack .../3-libpython2.7-stdlib_2.7.15~rc1-1_amd64.deb ...
Unpacking libpython2.7-stdlib:amd64 (2.7.15~rc1-1) ...
Selecting previously unselected package python2.7.
Preparing to unpack .../4-python2.7_2.7.15~rc1-1_amd64.deb ...
Unpacking python2.7 (2.7.15~rc1-1) ...
Selecting previously unselected package libpython-stdlib:amd64.
Preparing to unpack .../5-libpython-stdlib_2.7.15~rc1-1_amd64.deb ...
Unpacking libpython-stdlib:amd64 (2.7.15~rc1-1) ...
Setting up libpython2.7-minimal:amd64 (2.7.15~rc1-1) ...
Setting up python2.7-minimal (2.7.15~rc1-1) ...
Linking and byte-compiling packages for runtime python2.7...
Setting up python-minimal (2.7.15~rc1-1) ...
Selecting previously unselected package python.
(Reading database ... 57220 files and directories currently installed.)
Preparing to unpack .../00-python_2.7.15~rc1-1_amd64.deb ...
Unpacking python (2.7.15~rc1-1) ...
Selecting previously unselected package python-markupsafe.
Preparing to unpack .../01-python-markupsafe_1.0-1build1_amd64.deb ...
Unpacking python-markupsafe (1.0-1build1) ...
Selecting previously unselected package python-jinja2.
Preparing to unpack .../02-python-jinja2_2.10-1_all.deb ...
Unpacking python-jinja2 (2.10-1) ...
Selecting previously unselected package python-yaml.
Preparing to unpack .../03-python-yaml_3.12-1build2_amd64.deb ...
Unpacking python-yaml (3.12-1build2) ...
Selecting previously unselected package python-asn1crypto.
Preparing to unpack .../04-python-asn1crypto_0.24.0-1_all.deb ...
Unpacking python-asn1crypto (0.24.0-1) ...
Selecting previously unselected package python-cffi-backend.
Preparing to unpack .../05-python-cffi-backend_1.11.5-1_amd64.deb ...
Unpacking python-cffi-backend (1.11.5-1) ...
Selecting previously unselected package python-enum34.
Preparing to unpack .../06-python-enum34_1.1.6-2_all.deb ...
Unpacking python-enum34 (1.1.6-2) ...
Selecting previously unselected package python-idna.
Preparing to unpack .../07-python-idna_2.6-1_all.deb ...
Unpacking python-idna (2.6-1) ...
Selecting previously unselected package python-ipaddress.
Preparing to unpack .../08-python-ipaddress_1.0.17-1_all.deb ...
Unpacking python-ipaddress (1.0.17-1) ...
Selecting previously unselected package python-six.
Preparing to unpack .../09-python-six_1.11.0-2_all.deb ...
Unpacking python-six (1.11.0-2) ...
Selecting previously unselected package python-cryptography.
Preparing to unpack .../10-python-cryptography_2.1.4-1ubuntu1.2_amd64.deb ...
Unpacking python-cryptography (2.1.4-1ubuntu1.2) ...
Selecting previously unselected package python-pyasn1.
Preparing to unpack .../11-python-pyasn1_0.4.2-3_all.deb ...
Unpacking python-pyasn1 (0.4.2-3) ...
Selecting previously unselected package python-paramiko.
Preparing to unpack .../12-python-paramiko_2.0.0-1ubuntu1_all.deb ...
Unpacking python-paramiko (2.0.0-1ubuntu1) ...
Selecting previously unselected package python-httplib2.
Preparing to unpack .../13-python-httplib2_0.9.2+dfsg-1_all.deb ...
Unpacking python-httplib2 (0.9.2+dfsg-1) ...
Selecting previously unselected package python-crypto.
Preparing to unpack .../14-python-crypto_2.6.1-8ubuntu2_amd64.deb ...
Unpacking python-crypto (2.6.1-8ubuntu2) ...
Selecting previously unselected package python-pkg-resources.
Preparing to unpack .../15-python-pkg-resources_39.0.1-2_all.deb ...
Unpacking python-pkg-resources (39.0.1-2) ...
Selecting previously unselected package python-setuptools.
Preparing to unpack .../16-python-setuptools_39.0.1-2_all.deb ...
Unpacking python-setuptools (39.0.1-2) ...
Selecting previously unselected package sshpass.
Preparing to unpack .../17-sshpass_1.06-1_amd64.deb ...
Unpacking sshpass (1.06-1) ...
Selecting previously unselected package ansible.
Preparing to unpack .../18-ansible_2.7.0-1ppa~bionic_all.deb ...
Unpacking ansible (2.7.0-1ppa~bionic) ...
Processing triggers for mime-support (3.60ubuntu1) ...
Setting up sshpass (1.06-1) ...
Processing triggers for man-db (2.8.3-2) ...
Setting up libpython2.7-stdlib:amd64 (2.7.15~rc1-1) ...
Setting up python2.7 (2.7.15~rc1-1) ...
Setting up libpython-stdlib:amd64 (2.7.15~rc1-1) ...
Setting up python (2.7.15~rc1-1) ...
Setting up python-idna (2.6-1) ...
Setting up python-yaml (3.12-1build2) ...
Setting up python-asn1crypto (0.24.0-1) ...
Setting up python-crypto (2.6.1-8ubuntu2) ...
Setting up python-pyasn1 (0.4.2-3) ...
Setting up python-pkg-resources (39.0.1-2) ...
Setting up python-markupsafe (1.0-1build1) ...
Setting up python-httplib2 (0.9.2+dfsg-1) ...
Setting up python-cffi-backend (1.11.5-1) ...
Setting up python-six (1.11.0-2) ...
Setting up python-enum34 (1.1.6-2) ...
Setting up python-ipaddress (1.0.17-1) ...
Setting up python-setuptools (39.0.1-2) ...
Setting up python-jinja2 (2.10-1) ...
Setting up python-cryptography (2.1.4-1ubuntu1.2) ...
Setting up python-paramiko (2.0.0-1ubuntu1) ...
Setting up ansible (2.7.0-1ppa~bionic) ...
root@ansiblemaster:~# ansible --version
ansible 2.7.0
  config file = /etc/ansible/ansible.cfg
  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python2.7/dist-packages/ansible
  executable location = /usr/bin/ansible
  python version = 2.7.15rc1 (default, Apr 15 2018, 21:51:34) [GCC 7.3.0]
root@ansiblemaster:~# cd /etc/ssh/
root@ansiblemaster:/etc/ssh# vi sshd_config
root@ansiblemaster:/etc/ssh# service sshd restart
root@ansiblemaster:/etc/ssh# vi /etc/hosts
root@ansiblemaster:/etc/ssh# cd /etc/ansible/
root@ansiblemaster:/etc/ansible# ls
ansible.cfg  hosts  roles
root@ansiblemaster:/etc/ansible# cat hosts
# This is the default ansible 'hosts' file.
#
# It should live in /etc/ansible/hosts
#
#   - Comments begin with the '#' character
#   - Blank lines are ignored
#   - Groups of hosts are delimited by [header] elements
#   - You can enter hostnames or ip addresses
#   - A hostname/ip can be a member of multiple groups

# Ex 1: Ungrouped hosts, specify before any group headers.

## green.example.com
## blue.example.com
## 192.168.100.1
## 192.168.100.10

# Ex 2: A collection of hosts belonging to the 'webservers' group

## [webservers]
## alpha.example.org
## beta.example.org
## 192.168.1.100
## 192.168.1.110

# If you have multiple hosts following a pattern you can specify
# them like this:

## www[001:006].example.com

# Ex 3: A collection of database servers in the 'dbservers' group

## [dbservers]
##
## db01.intranet.mydomain.net
## db02.intranet.mydomain.net
## 10.25.1.56
## 10.25.1.57

# Here's another example of host ranges, this time there are no
# leading 0s:

## db-[99:101]-node.example.com

root@ansiblemaster:/etc/ansible# vi hosts
root@ansiblemaster:/etc/ansible# cat hosts
# This is the default ansible 'hosts' file.
#
# It should live in /etc/ansible/hosts
#
#   - Comments begin with the '#' character
#   - Blank lines are ignored
#   - Groups of hosts are delimited by [header] elements
#   - You can enter hostnames or ip addresses
#   - A hostname/ip can be a member of multiple groups

# Ex 1: Ungrouped hosts, specify before any group headers.

## green.example.com
## blue.example.com
## 192.168.100.1
## 192.168.100.10

# Ex 2: A collection of hosts belonging to the 'webservers' group

[dba]
agent agent=172.31.36.129
ansiblemaster ansiblemaster=172.31.42.33


## [webservers]
## alpha.example.org
## beta.example.org
## 192.168.1.100
## 192.168.1.110

# If you have multiple hosts following a pattern you can specify
# them like this:

## www[001:006].example.com

# Ex 3: A collection of database servers in the 'dbservers' group

## [dbservers]
##
## db01.intranet.mydomain.net
## db02.intranet.mydomain.net
## 10.25.1.56
## 10.25.1.57

# Here's another example of host ranges, this time there are no
# leading 0s:

## db-[99:101]-node.example.com

root@ansiblemaster:/etc/ansible# cat /etc/host
cat: /etc/host: No such file or directory
root@ansiblemaster:/etc/ansible# cat /etc/hosts
127.0.0.1 localhost
172.31.36.129 agent agent.localdomain.com
172.31.42.33 ansiblemaster master.localdomain.com172.31.42.33172.31.42.33

# The following lines are desirable for IPv6 capable hosts
::1 ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts
root@ansiblemaster:/etc/ansible# ping agent
PING agent (172.31.36.129) 56(84) bytes of data.
64 bytes from agent (172.31.36.129): icmp_seq=1 ttl=255 time=0.776 ms
64 bytes from agent (172.31.36.129): icmp_seq=2 ttl=255 time=0.739 ms
64 bytes from agent (172.31.36.129): icmp_seq=3 ttl=255 time=0.721 ms
64 bytes from agent (172.31.36.129): icmp_seq=4 ttl=255 time=0.642 ms
64 bytes from agent (172.31.36.129): icmp_seq=5 ttl=255 time=0.569 ms
^C
--- agent ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4085ms
rtt min/avg/max/mdev = 0.569/0.689/0.776/0.078 ms
root@ansiblemaster:/etc/ansible# ping agent
PING agent (172.31.36.129) 56(84) bytes of data.
64 bytes from agent (172.31.36.129): icmp_seq=1 ttl=255 time=0.687 ms
64 bytes from agent (172.31.36.129): icmp_seq=2 ttl=255 time=0.576 ms
64 bytes from agent (172.31.36.129): icmp_seq=3 ttl=255 time=0.617 ms
^C
--- agent ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2054ms
rtt min/avg/max/mdev = 0.576/0.626/0.687/0.054 ms
root@ansiblemaster:/etc/ansible# cat /etc/hosts
127.0.0.1 localhost
172.31.36.129 agent agent.localdomain.com
172.31.42.33 ansiblemaster master.localdomain.com172.31.42.33172.31.42.33

# The following lines are desirable for IPv6 capable hosts
::1 ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts
root@ansiblemaster:/etc/ansible# vi /etc/hosts
root@ansiblemaster:/etc/ansible# cat /etc/hosts
127.0.0.1 localhost
172.31.36.129 agent agent.localdomain.com
172.31.42.33 ansiblemaster master.localdomain.com

# The following lines are desirable for IPv6 capable hosts
::1 ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts
root@ansiblemaster:/etc/ansible# ansible agent -m ping -u root
The authenticity of host 'agent (172.31.36.129)' can't be established.
ECDSA key fingerprint is SHA256:uP+ie0Ae9FYq2+1YVGT61LtSikLrRuwGLaH1KL9M1ac.
Are you sure you want to continue connecting (yes/no)? yes
agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Warning: Permanently added 'agent,172.31.36.129' (ECDSA) to the list of known hosts.\r\nroot@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /root/.ssh/id_rsa.
Your public key has been saved in /root/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:3KbUGAl6/oXkyKl5LBYKLWvBHIJr7CqX67MRh8hCQck root@ansiblemaster
The key's randomart image is:
+---[RSA 2048]----+
|oo.   .          |
|.E.  . . .       |
|oo  . . +        |
|B+.. + * *       |
|*B+ o = S =      |
|++.+ = o +       |
|.oo.= o o        |
|+ +o o           |
|oo++             |
+----[SHA256]-----+
root@ansiblemaster:/etc/ansible# ssh-copy-id root@52.23.219.76
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/root/.ssh/id_rsa.pub"
The authenticity of host '52.23.219.76 (52.23.219.76)' can't be established.
ECDSA key fingerprint is SHA256:uP+ie0Ae9FYq2+1YVGT61LtSikLrRuwGLaH1KL9M1ac.
Are you sure you want to continue connecting (yes/no)? yes
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
root@52.23.219.76: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# ssh-copy-id root@172.31.36.129
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/root/.ssh/id_rsa.pub"
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
root@172.31.36.129: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# cd
root@ansiblemaster:~# ls -a
.  ..  .ansible  .bash_history  .bashrc  .profile  .ssh  .viminfo  snap
root@ansiblemaster:~# cd .ssh
root@ansiblemaster:~/.ssh# ls
authorized_keys  id_rsa  id_rsa.pub  known_hosts
root@ansiblemaster:~/.ssh# cat id_rsa.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC2LSp29O0i6EiLLiiCrB7pyw1TKNxo+5Ghhtc8eLnw8KRvXsRjqPuc8/1j6sl0SrpZWQcgLxel+68E9OADoYfAqptCZ9hP4TssOiGaCLGPC23PclMEF9MuWamhozoizJ92TIAaWjukDAaeqfy0bwlsCKcyTgyFbqW8Nj9vFyWXDmUt6QnErKmdha4xjraFc7xyo8vfeX4bLrbKRevRy4ijR9xehpEWD+N+XaOeoZCXWNrstkoj8TiAngpbRFiq7x+Skgzhu8WJsnv4dxAQzu+Y7paGCjpIp+7MJykI6FkgvoFhgFNbaMDS4ZRHXTCRxjs7GXCtd8A8eCLgEPJNsnkD root@ansiblemaster
root@ansiblemaster:~/.ssh# passwd root
Enter new UNIX password:
Retype new UNIX password:
passwd: password updated successfully
root@ansiblemaster:~/.ssh# ansible agent -m ping -u root
agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}
root@ansiblemaster:~/.ssh# cat authorized_keys
no-port-forwarding,no-agent-forwarding,no-X11-forwarding,command="echo 'Please login as the user \"ubuntu\" rather than the user \"root\".';echo;sleep 10" ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCwjCuWAKCjhHDrIVL46CYAsTl0UtRGuNJfFM4wiByusqMxvD2pwp6iEd95AxNS4dHNTGy38itI7HfM8MX8fm686DKliOS/FYeKyVT7GWfIf1iMYQMCSuLXnQbNqzHo38kpqD8+YpHsva6QUMNOZ8YwH4amrQkAkh0anjXTR1T3vyjfmwRVVImzAkpPLB8L1MZA1nlc4+5IKIj/SEKXgw8ScAp4whIGsYr0TyElLlnvOTmP/zFWs9O10PfzC36FaCimIvWWyYIDMhyJ49dts5/8aEqQVKUe0CXaf3gnW+Bb7N+4JYIbZPs3ez5je/PtbnH6MKJgwkimYBSqZ1fUoxjr aws_pemkey
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDWd2EqN9Hs8T81butstjheAVS3Z4KiyywD6Yi0DUpTOtF/Zq3cUiPDlkQGANifREJiB8Dy6cpX7RMShJnl1RHJ8DAOt5+PBijuyQnPUETZsELkOtjH0nDcmN6tyrY3+AzKHsFpu51vmWFOI4o9tNWI+E+k0VbrBNVT5kb4J6VcV0K6PsFGzfBQ5E5aZsuw51ipTipzil6oaYZK2xkpOUqlPDFlDfDjWXh1pxdxWzM5tRfdRafpUjCDQMckvVzv52U5894M9sQeHSUI4l65mJRHPJBR8mf+3kw1A31QlF/xdznF4xRYYXdhRNTqOpvWmd3ka+liZDA1h0xx1M98vfFP root@agent
root@ansiblemaster:~/.ssh# cd /etc/ansible/
root@ansiblemaster:/etc/ansible# ls
ansible.cfg  hosts  roles
root@ansiblemaster:/etc/ansible# vi hosts
root@ansiblemaster:/etc/ansible# ping agent
PING agent (172.31.36.129) 56(84) bytes of data.
64 bytes from agent (172.31.36.129): icmp_seq=1 ttl=255 time=0.577 ms
64 bytes from agent (172.31.36.129): icmp_seq=2 ttl=255 time=0.739 ms
^C
--- agent ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1002ms
rtt min/avg/max/mdev = 0.577/0.658/0.739/0.081 ms
root@ansiblemaster:/etc/ansible# ansible agent -m ping -u root -k
SSH password:
agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# ansible agent -m ping -u root
agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# ls
ansible.cfg  hosts  roles
root@ansiblemaster:/etc/ansible# ansible  -m ping all
The authenticity of host 'ansiblemaster (172.31.42.33)' can't be established.
ECDSA key fingerprint is SHA256:hCiVqHrzxPwNJg3HIZ9kZUjCg5FFKWqSLGmY4Cdpghk.
Are you sure you want to continue connecting (yes/no)? agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}

ansiblemaster | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Host key verification failed.\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# ansible -m ping all
The authenticity of host 'ansiblemaster (172.31.42.33)' can't be established.
ECDSA key fingerprint is SHA256:hCiVqHrzxPwNJg3HIZ9kZUjCg5FFKWqSLGmY4Cdpghk.
Are you sure you want to continue connecting (yes/no)? agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}

ansiblemaster | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Host key verification failed.\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# vi hosts
root@ansiblemaster:/etc/ansible# ansible -m ping all
The authenticity of host 'ansiblemaster (172.31.42.33)' can't be established.
ECDSA key fingerprint is SHA256:hCiVqHrzxPwNJg3HIZ9kZUjCg5FFKWqSLGmY4Cdpghk.
Are you sure you want to continue connecting (yes/no)? agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}

ansiblemaster | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Host key verification failed.\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# ansible agent -m ping -u root
agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# ssh root@52.23.219.76
root@52.23.219.76: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# ssh root@172.31.36.129
root@172.31.36.129: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# vi /etc/ssh/sshd_config
root@ansiblemaster:/etc/ansible# service sshd restart
root@ansiblemaster:/etc/ansible# ssh root@172.31.36.129
root@172.31.36.129: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# ssh-copy-id root@172.31.36.129
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/root/.ssh/id_rsa.pub"
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
root@172.31.36.129: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# ssh-copy-id root@172.31.36.129
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/root/.ssh/id_rsa.pub"
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
root@172.31.36.129: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# ssh root@172.31.36.129
root@172.31.36.129: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# ssh root@172.31.36.129
root@172.31.36.129: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# ssh root@172.31.36.129
root@172.31.36.129: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# ssh root@172.31.36.129
root@172.31.36.129: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# cat>aws_pemkey.pem
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAsIwrlgCgo4Rw6yFS+OgmALE5dFLURrjSXxTOMIgcrrKjMbw9qcKeohHfeQMT
UuHRzUxst/IrSOx3zPDF/H5uvOgypYjkvxWHislU+xlnyH9YjGEDAkri150Gzasx6N/JKag/PmKR
7L2ukFDDTmfGMB+Gpq0JAJIdGp4100dU978o35sEVVSJswJKTywfC9TGQNZ5XOPuSCiI/0hCl4MP
EnAKeMISBrGK9E8hJS5Z7zk5j/8xVrPTtdD38wt+hWgopiL1lsmCAzIciePXbbOf/GhKkFSlHtAl
2n94J1vgW+zfuCWCG2T7N3s+Y3vz7W5x+jCiYMJIpmAUqmdX1KMY6wIDAQABAoIBAQCcl2ddgCb7
glBprcAbeEWk3YzZaVJRfENUBG8ySrguF9J6Hb4P4ci0defiPOEZ5aQiVUQlD85mux8zjuf9IeN0
+PtbKgXCmwUDC7qtkYYlJxbSRIXXtbZoiiXrrInzRPL3WPznh6Ro+IFqDch9tbvrGTtkgRv3/qGD
54pUYPOzXcQeLS7j24ggFavCDOXXOGyXtj09wYOz8ym2R+gxnwLWU//CxEYMxvLC1rUmHCQDJdyJ
8E+8UM63sLdnnLKRKuGT3knRAL7uAXh9YTqXuaFGSAIxRFnRFruIGOQr6ck7XQ8wDI4wPDpmkH4W
N/E6qqbGnbAVX7hb8NE9foasPztRAoGBAPdNup46Vnl08D9mEnWhD/pVA50dV/RSp65npaJhXD5s
S/tofvDxd895ShPV+nwbJPK3D1q5uwF4r3Alsy93bEhL1rKrxzsP2Jg2xRF+nxS6a2Qy60TQMN4y
TQfo9WKoTEVbaMUzibAHhEmDdjgvzRr3qyp+1NE60xcgz2nENYUzAoGBALbBe4Hiu+FXcVvqHVty
uuEsnbRMsZxnH2dYt45R9kNqaiBFXrC0s/5nllTE+1qXqUvURzFs3Vy3RiG2K7Ds3kYZcflmmaf0
QnExwtuCYTn0uRAgdTj7XLg00tk2wnWF1VNBPESRPunqy8N/rQ6QZbUybQ7puBmabjbl7uG5pK1p
AoGBAKID20nD4FkrwiVWwqsrfGM9BOQOkEuxRsdcgcfSzvLaUiD/wYIqP5q91EkQe0yJH/ie80E1
wozhOtZW7IAhVeA7RwnAvgI0jGqUHyEp+iBDTQ3UygtH9WvsOkj/VptutKEPlKD09bRMCF9875s5
vb54GTv64YO9bQOO7DNXZtS/AoGAfhsIRFnV1upluEzVsRJ7zYDh2VXKgOfPjZp0HmqECYTWcior
6rbmNLf5zciWwK5CDacO8RXzsVRtujlf8Jeh0LEiKjwX7wLnDgCOOrW+rSUmxe//szAPjLQ2gdf9
WubcirRLB+1JglOYAvCI07Hj3KJNCqtPc6tSPeNvcKaO8XECgYB8WvTp+C9ivTzT8FyXBvums8G2
/p0DjD/CuUlPf/9wkamJSCD8wdSHBKebgG4wLKqWakB1gy7xRPTjvj30RqcIrUz3CYF84bjIGGl8
j0aDVZyLpaEagHdVOUONbXhlethkedIzYKgfD4lQ0sj+WUU2p2zgXqTed7Ociy6BbPR/pA==
-----END RSA PRIVATE KEY-----
^C
root@ansiblemaster:/etc/ansible# ls
ansible.cfg  aws_pemkey.pem  hosts  roles
root@ansiblemaster:/etc/ansible# ssh root@172.31.36.129
root@172.31.36.129: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# vi /etc/hosts
root@ansiblemaster:/etc/ansible# ssh root@172.31.36.129
root@172.31.36.129: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# ssh root@172.31.36.129
root@172.31.36.129: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# ping agent
PING agent (172.31.36.129) 56(84) bytes of data.
64 bytes from agent (172.31.36.129): icmp_seq=1 ttl=255 time=0.578 ms
64 bytes from agent (172.31.36.129): icmp_seq=2 ttl=255 time=0.623 ms
64 bytes from agent (172.31.36.129): icmp_seq=3 ttl=255 time=0.561 ms
64 bytes from agent (172.31.36.129): icmp_seq=4 ttl=255 time=0.625 ms
64 bytes from agent (172.31.36.129): icmp_seq=5 ttl=255 time=0.576 ms
^C
--- agent ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4094ms
rtt min/avg/max/mdev = 0.561/0.592/0.625/0.037 ms
root@ansiblemaster:/etc/ansible# ansible all -m ping
The authenticity of host 'ansiblemaster (172.31.42.33)' can't be established.
ECDSA key fingerprint is SHA256:hCiVqHrzxPwNJg3HIZ9kZUjCg5FFKWqSLGmY4Cdpghk.
Are you sure you want to continue connecting (yes/no)? agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}

ansiblemaster | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Host key verification failed.\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# ansible webserver -m ping -vvv
ansible 2.7.0
  config file = /etc/ansible/ansible.cfg
  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python2.7/dist-packages/ansible
  executable location = /usr/bin/ansible
  python version = 2.7.15rc1 (default, Apr 15 2018, 21:51:34) [GCC 7.3.0]
Using /etc/ansible/ansible.cfg as config file
Parsed /etc/ansible/hosts inventory source with ini plugin
 [WARNING]: Could not match supplied host pattern, ignoring: webserver

 [WARNING]: No hosts matched, nothing to do

root@ansiblemaster:/etc/ansible# ansible -m ping all
The authenticity of host 'ansiblemaster (172.31.42.33)' can't be established.
ECDSA key fingerprint is SHA256:hCiVqHrzxPwNJg3HIZ9kZUjCg5FFKWqSLGmY4Cdpghk.
Are you sure you want to continue connecting (yes/no)? agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}

ansiblemaster | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Host key verification failed.\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# vi ansible.cfg
root@ansiblemaster:/etc/ansible# ansible -m ping all
The authenticity of host 'ansiblemaster (172.31.42.33)' can't be established.
ECDSA key fingerprint is SHA256:hCiVqHrzxPwNJg3HIZ9kZUjCg5FFKWqSLGmY4Cdpghk.
Are you sure you want to continue connecting (yes/no)? agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}

ansiblemaster | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Host key verification failed.\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# vi ansible.cfg
root@ansiblemaster:/etc/ansible# vi ansible.cfg
root@ansiblemaster:/etc/ansible# ansible -m ping all
The authenticity of host 'ansiblemaster (172.31.42.33)' can't be established.
ECDSA key fingerprint is SHA256:hCiVqHrzxPwNJg3HIZ9kZUjCg5FFKWqSLGmY4Cdpghk.
Are you sure you want to continue connecting (yes/no)? agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}

ansiblemaster | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Host key verification failed.\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# ping ansiblemaster
PING ansiblemaster (172.31.42.33) 56(84) bytes of data.
64 bytes from ansiblemaster (172.31.42.33): icmp_seq=1 ttl=64 time=0.019 ms
64 bytes from ansiblemaster (172.31.42.33): icmp_seq=2 ttl=64 time=0.040 ms
64 bytes from ansiblemaster (172.31.42.33): icmp_seq=3 ttl=64 time=0.040 ms
^C
--- ansiblemaster ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2029ms
rtt min/avg/max/mdev = 0.019/0.033/0.040/0.009 ms
root@ansiblemaster:/etc/ansible# ssh root@54.196.124.55
The authenticity of host '54.196.124.55 (54.196.124.55)' can't be established.
ECDSA key fingerprint is SHA256:hCiVqHrzxPwNJg3HIZ9kZUjCg5FFKWqSLGmY4Cdpghk.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '54.196.124.55' (ECDSA) to the list of known hosts.
root@54.196.124.55's password:
Welcome to Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-1021-aws x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Tue Oct 16 06:25:55 UTC 2018

  System load:  0.05              Processes:           99
  Usage of /:   20.3% of 7.69GB   Users logged in:     1
  Memory usage: 22%               IP address for eth0: 172.31.42.33
  Swap usage:   0%

 * Security certifications for Ubuntu!
   We now have FIPS, STIG, CC and a CIS Benchmark.

   - http://bit.ly/Security_Certification

 * Want to make a highly secure kiosk, smart display or touchscreen?
   Here's a step-by-step tutorial for a rainy weekend, or a startup.

   - https://bit.ly/secure-kiosk


  Get cloud support with Ubuntu Advantage Cloud Guest:
    http://www.ubuntu.com/business/services/cloud

 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

28 packages can be updated.
0 updates are security updates.


*** System restart required ***
root@ansiblemaster:~# exit
logout
Connection to 54.196.124.55 closed.
root@ansiblemaster:/etc/ansible# ssh root@172.31.36.129
root@172.31.36.129: Permission denied (publickey).
root@ansiblemaster:/etc/ansible# ansible -m ping all
The authenticity of host 'ansiblemaster (172.31.42.33)' can't be established.
ECDSA key fingerprint is SHA256:hCiVqHrzxPwNJg3HIZ9kZUjCg5FFKWqSLGmY4Cdpghk.
Are you sure you want to continue connecting (yes/no)? agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}

ansiblemaster | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Host key verification failed.\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# ansible -m ping all
The authenticity of host 'ansiblemaster (172.31.42.33)' can't be established.
ECDSA key fingerprint is SHA256:hCiVqHrzxPwNJg3HIZ9kZUjCg5FFKWqSLGmY4Cdpghk.
Are you sure you want to continue connecting (yes/no)? agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}

ansiblemaster | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Host key verification failed.\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# ansible -m ping all yes
Usage: ansible <host-pattern> [options]

Define and run a single task 'playbook' against a set of hosts

Options:
  -a MODULE_ARGS, --args=MODULE_ARGS
                        module arguments
  --ask-vault-pass      ask for vault password
  -B SECONDS, --background=SECONDS
                        run asynchronously, failing after X seconds
                        (default=N/A)
  -C, --check           don't make any changes; instead, try to predict some
                        of the changes that may occur
  -D, --diff            when changing (small) files and templates, show the
                        differences in those files; works great with --check
  -e EXTRA_VARS, --extra-vars=EXTRA_VARS
                        set additional variables as key=value or YAML/JSON, if
                        filename prepend with @
  -f FORKS, --forks=FORKS
                        specify number of parallel processes to use
                        (default=5)
  -h, --help            show this help message and exit
  -i INVENTORY, --inventory=INVENTORY, --inventory-file=INVENTORY
                        specify inventory host path or comma separated host
                        list. --inventory-file is deprecated
  -l SUBSET, --limit=SUBSET
                        further limit selected hosts to an additional pattern
  --list-hosts          outputs a list of matching hosts; does not execute
                        anything else
  -m MODULE_NAME, --module-name=MODULE_NAME
                        module name to execute (default=command)
  -M MODULE_PATH, --module-path=MODULE_PATH
                        prepend colon-separated path(s) to module library
                        (default=[u'/root/.ansible/plugins/modules',
                        u'/usr/share/ansible/plugins/modules'])
  -o, --one-line        condense output
  --playbook-dir=BASEDIR
                        Since this tool does not use playbooks, use this as a
                        subsitute playbook directory.This sets the relative
                        path for many features including roles/ group_vars/
                        etc.
  -P POLL_INTERVAL, --poll=POLL_INTERVAL
                        set the poll interval if using -B (default=15)
  --syntax-check        perform a syntax check on the playbook, but do not
                        execute it
  -t TREE, --tree=TREE  log output to this directory
  --vault-id=VAULT_IDS  the vault identity to use
  --vault-password-file=VAULT_PASSWORD_FILES
                        vault password file
  -v, --verbose         verbose mode (-vvv for more, -vvvv to enable
                        connection debugging)
  --version             show program's version number and exit

  Connection Options:
    control as whom and how to connect to hosts

    -k, --ask-pass      ask for connection password
    --private-key=PRIVATE_KEY_FILE, --key-file=PRIVATE_KEY_FILE
                        use this file to authenticate the connection
    -u REMOTE_USER, --user=REMOTE_USER
                        connect as this user (default=None)
    -c CONNECTION, --connection=CONNECTION
                        connection type to use (default=smart)
    -T TIMEOUT, --timeout=TIMEOUT
                        override the connection timeout in seconds
                        (default=10)
    --ssh-common-args=SSH_COMMON_ARGS
                        specify common arguments to pass to sftp/scp/ssh (e.g.
                        ProxyCommand)
    --sftp-extra-args=SFTP_EXTRA_ARGS
                        specify extra arguments to pass to sftp only (e.g. -f,
                        -l)
    --scp-extra-args=SCP_EXTRA_ARGS
                        specify extra arguments to pass to scp only (e.g. -l)
    --ssh-extra-args=SSH_EXTRA_ARGS
                        specify extra arguments to pass to ssh only (e.g. -R)

  Privilege Escalation Options:
    control how and which user you become as on target hosts

    -s, --sudo          run operations with sudo (nopasswd) (deprecated, use
                        become)
    -U SUDO_USER, --sudo-user=SUDO_USER
                        desired sudo user (default=root) (deprecated, use
                        become)
    -S, --su            run operations with su (deprecated, use become)
    -R SU_USER, --su-user=SU_USER
                        run operations with su as this user (default=None)
                        (deprecated, use become)
    -b, --become        run operations with become (does not imply password
                        prompting)
    --become-method=BECOME_METHOD
                        privilege escalation method to use (default=sudo),
                        valid choices: [ sudo | su | pbrun | pfexec | doas |
                        dzdo | ksu | runas | pmrun | enable | machinectl ]
    --become-user=BECOME_USER
                        run operations as this user (default=root)
    --ask-sudo-pass     ask for sudo password (deprecated, use become)
    --ask-su-pass       ask for su password (deprecated, use become)
    -K, --ask-become-pass
                        ask for privilege escalation password

Some modules do not make sense in Ad-Hoc (include, meta, etc)
ERROR! Extraneous options or arguments
root@ansiblemaster:/etc/ansible# ansible -m ping all -yes
Usage: ansible <host-pattern> [options]

ansible: error: no such option: -y
root@ansiblemaster:/etc/ansible# ansible -m ping all
The authenticity of host 'ansiblemaster (172.31.42.33)' can't be established.
ECDSA key fingerprint is SHA256:hCiVqHrzxPwNJg3HIZ9kZUjCg5FFKWqSLGmY4Cdpghk.
Are you sure you want to continue connecting (yes/no)? agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}

ansiblemaster | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Host key verification failed.\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# ansible agent -m ping -u root
agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible# ansible agent -m ping -u root -k
SSH password:
agent | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@agent: Permission denied (publickey).\r\n",
    "unreachable": true
}
root@ansiblemaster:/etc/ansible#
*************************************************************************************************
***********************************************************************************************
Authenticating with public key "imported-openssh-key"
     ┌────────────────────────────────────────────────────────────────────┐
     │                        • MobaXterm 10.8 •                          │
     │            (SSH client, X-server and networking tools)             │
     │                                                                    │
     │ ➤ SSH session to ec2-user@52.23.219.76                             │
     │   • SSH compression : ✔                                            │
     │   • SSH-browser     : ✔                                            │
     │   • X11-forwarding  : ✘  (disabled or not supported by server)     │
     │   • DISPLAY         : 192.168.0.116:0.0                            │
     │                                                                    │
     │ ➤ For more info, ctrl+click on help or visit our website           │
     └────────────────────────────────────────────────────────────────────┘


       __|  __|_  )
       _|  (     /   Amazon Linux AMI
      ___|\___|___|

https://aws.amazon.com/amazon-linux-ami/2018.03-release-notes/
11 package(s) needed for security, out of 20 available
Run "sudo yum update" to apply all updates.
[ec2-user@ip-172-31-36-129 ~]$ sudo -i
[root@ip-172-31-36-129 ~]# vi /etc/hostname
[root@ip-172-31-36-129 ~]# hostname agent
[root@ip-172-31-36-129 ~]# exec bash
[root@agent ~]# vi /etc/hosts
[root@agent ~]# ping master
ping: unknown host master
[root@agent ~]# ping ansiblemaster
PING ansiblemaster (172.31.42.33) 56(84) bytes of data.
64 bytes from ansiblemaster (172.31.42.33): icmp_seq=1 ttl=64 time=0.562 ms
64 bytes from ansiblemaster (172.31.42.33): icmp_seq=2 ttl=64 time=0.605 ms
64 bytes from ansiblemaster (172.31.42.33): icmp_seq=3 ttl=64 time=0.642 ms
^C
--- ansiblemaster ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2038ms
rtt min/avg/max/mdev = 0.562/0.603/0.642/0.032 ms
[root@agent ~]# vi /etc/ssh/
[root@agent ~]# ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /root/.ssh/id_rsa.
Your public key has been saved in /root/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:BYoCBGc5ThXQQyOe7BpzUaJ+C29/gpR0aAMbJbKBUwM root@agent
The key's randomart image is:
+---[RSA 2048]----+
|E=XB*.  .        |
|+%=*oo . .       |
|o+X.o..   .      |
|.o.B .   .       |
|oo=.+   S        |
| =+o.            |
|. .+.            |
|  .... .         |
|     .o          |
+----[SHA256]-----+
[root@agent ~]# ls -a
.  ..  .bash_history  .bash_logout  .bash_profile  .bashrc  .cshrc  .ssh  .tcshrc
[root@agent ~]# cd .ssh
[root@agent .ssh]# ls
authorized_keys  id_rsa  id_rsa.pub
[root@agent .ssh]# cat>>authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC2LSp29O0i6EiLLiiCrB7pyw1TKNxo+5Ghhtc8eLnw8KRvXsRjqPuc8/1j6sl0SrpZWQcgLxel+68E9OADoYfAqptCZ9hP4TssOiGaCLGPC23PclMEF9MuWamhozoizJ92TIAaWjukDAaeqfy0bwlsCKcyTgyFbqW8Nj9vFyWXDmUt6QnErKmdha4xjraFc7xyo8vfeX4bLrbKRevRy4ijR9xehpEWD+N+XaOeoZCXWNrstkoj8TiAngpbRFiq7x+Skgzhu8WJsnv4dxAQzu+Y7paGCjpIp+7MJykI6FkgvoFhgFNbaMDS4ZRHXTCRxjs7GXCtd8A8eCLgEPJNsnkD root@ansiblemaster
[root@agent .ssh]# ssh-copy-id root@172.31.42.33
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/root/.ssh/id_rsa.pub"
The authenticity of host '172.31.42.33 (172.31.42.33)' can't be established.
ECDSA key fingerprint is SHA256:hCiVqHrzxPwNJg3HIZ9kZUjCg5FFKWqSLGmY4Cdpghk.
ECDSA key fingerprint is MD5:34:da:c4:3c:9d:03:17:84:c7:45:49:88:08:7d:81:f3.
Are you sure you want to continue connecting (yes/no)? yes
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
root@172.31.42.33's password:
Permission denied, please try again.
root@172.31.42.33's password:
Permission denied, please try again.
root@172.31.42.33's password:

Number of key(s) added: 1

Now try logging into the machine, with:   "ssh 'root@172.31.42.33'"
and check to make sure that only the key(s) you wanted were added.

[root@agent .ssh]# ssh-copy-id root@172.31.42.33
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/root/.ssh/id_rsa.pub"
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed

/usr/bin/ssh-copy-id: WARNING: All keys were skipped because they already exist on the remote system.
                (if you think this is a mistake, you may want to use -f option)

[root@agent .ssh]# ping master
ping: unknown host master
[root@agent .ssh]# ping ansiblemaster
PING ansiblemaster (172.31.42.33) 56(84) bytes of data.
64 bytes from ansiblemaster (172.31.42.33): icmp_seq=1 ttl=64 time=0.724 ms
64 bytes from ansiblemaster (172.31.42.33): icmp_seq=2 ttl=64 time=0.597 ms
64 bytes from ansiblemaster (172.31.42.33): icmp_seq=3 ttl=64 time=0.675 ms
^C64 bytes from ansiblemaster (172.31.42.33): icmp_seq=4 ttl=64 time=0.629 ms
64 bytes from ansiblemaster (172.31.42.33): icmp_seq=5 ttl=64 time=0.703 ms
64 bytes from ansiblemaster (172.31.42.33): icmp_seq=6 ttl=64 time=0.571 ms
^C
--- ansiblemaster ping statistics ---
6 packets transmitted, 6 received, 0% packet loss, time 5119ms
rtt min/avg/max/mdev = 0.571/0.649/0.724/0.064 ms
[root@agent .ssh]# vi /etc/hosts
[root@agent .ssh]#
───────────────────────────────────────────────────────────────────────────────────────────────────────────
[ec2-user@agent ~]$ sudo yum install python





Session stopped
    - Press <return> to exit tab
    - Press R to restart session
    - Press S to save terminal output to file

Network error: Software caused connection abort

